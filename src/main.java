                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       import java.io.*;
import java.util.*;
import java.io.*;

public class main{
    static String[] args={ };
    public static void main(String[] args) throws IOException{
        System.out.println("\u000C Welcome to Election Program ");        
        System.out.println("CopyLeft Gaurab Banerjee \n\n");  
        System.out.println(" C :To Choose Data File. "); 
        System.out.println(" K :To Encrypt/Decrypt Data File. ");
        System.out.println(" E :To Exit. ");
        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
        String ch = (br.readLine());
        switch (ch){
           case "C" :
           {
              choosefile();   
              break;   
           }
           
           case "K" :
           {
              efile();   
              break;   
           }
                       
           case "E" :
           {
              exit();
              System.exit(1);   
           }
           
           default : {System.out.println("Wrong Choice.."); main(args);}
        }
    }
    
    
    public static void choosefile() throws IOException{
       BufferedReader fr=new BufferedReader(new InputStreamReader(System.in));
       System.out.println("\u000C Enter filename:");
       String fname=fr.readLine();
       System.out.println("Entered filename is :: "+fname);
       fname=fname.trim();
       fname=fname+".decrypted";
       try {
           BufferedReader fi=new BufferedReader(new FileReader(fname));
        }
        catch (Exception e){
            System.out.println("File not found. Creating defaults file...");
            DataOutputStream wr = new DataOutputStream(new FileOutputStream (fname));
            createfile(fname);
        }
       readfile(fname);
    }
    
    public static void createfile(String fname){
        try {
        PrintWriter fw = new PrintWriter (new BufferedWriter(new FileWriter(fname, true)));
        fw.print("Name|Post|Votes");
        fw.close();
        readfile(fname);
      }
      catch (Exception e){
        System.out.println(e);
        }
    }
    
    public static void readfile(String fname){
        try {
        BufferedReader fi=new BufferedReader(new FileReader(fname));
        System.out.println("\u000C File contents::");
        String ln="";        
         while((ln=fi.readLine())!=null){
             
            System.out.println("\n\t"+ln.substring(0,ln.lastIndexOf("|")));
        }
        vote(fname);
       }
       catch (Exception e){
        System.out.println(e);
        } 
    }
    
    public static void vote(String fname)throws IOException{
        System.out.println("\n\n\n\n\n V: For Vote");
        System.out.println(" R: For Results");
        System.out.println(" M: For Main()");
        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
        String ch = (br.readLine());
        switch (ch){
           case "V" :
           {
              vote1(fname);   
              break;   
           }
                       
           case "R" :
           {
             resultt1(fname);
             break;   
           }
           case "M" :
           {
             main(args);  
             break;   
           }
           
           default : {System.out.println("Wrong Choice.."); vote(fname);}
        }
        
    }
    public static void vote1(String fname)throws IOException{
       System.out.println("\u000C ");
       int i = 0, j=0;
       String[][] result = new String[999][3];    
       BufferedReader reader = new BufferedReader(new FileReader(fname));
       String line = "";           
       String  lin1;            
        while((line=reader.readLine())!=null){
           for (j = 0; j <3; j++) {
               if(line==""){break;}
               if(j<2){
                   lin1=line.substring(0,line.indexOf("|"));
                   result[i][j]=lin1;
                   line=line.substring((line.indexOf("|"))+1);
                   }
               else{
                   result[i][j]=line;
               }                 
            }
            i++;
         }         
        for(int i1=0; i1<=i; i1++){
           for(j=0; j<3; j++){
               System.out.print("\t"+result[i1][j]);
           }
           System.out.println();
        } 
        System.out.println("\n\n");
        vote2(result,i,fname);
      }    
    
    public static void vote2( String result[][], int i, String fname)throws IOException{
        System.out.println("\u000C :::::::::::::::::VOTING:::::::::::::::::");
        System.out.println("\n\nAvailable Candidates::");
        System.out.println("\tName\tPost\tSerialNumber");
        for(int i1=1; i1<i; i1++){
                for(int j=0; j<2; j++){
                    System.out.print("\t"+result[i1][j]);
                }
                System.out.print("\t"+i1);
                System.out.println();
            } 
        System.out.println(" N :Add new candidate");
        System.out.println(" V : Cast your vote");
        System.out.println(" M : Main()");
        Scanner sc=new Scanner(System.in);
        String ch=sc.nextLine();
        switch (ch)
        {
            case "N" :
            {
                String result1[][]=newcandidate( result, i , fname);
                for(int i1=0; i1<=i; i1++){
                for(int j=0; j<3; j++){
                    result[i][j]=result1[i][j];
                }
              } 
                vote2(result,i,fname);
                break;
            }
            case "V" :
            {
                String result1[][] =poll(result,i,fname);
                for(int i1=0; i1<=i; i1++){
                for(int j=0; j<3; j++){
                    result[i][j]=result1[i][j];
                }
              } 
                vote2(result,i,fname);
                break;
            }
            case "M" :
            {
                main(args);
                break;
            }
            default:{System.out.println("Wrong choice..."); vote2(result,i,fname);}
        }
                
        
    }
    public static String[][] newcandidate(String result[][] ,int i, String fname){
          try {
        PrintWriter fw = new PrintWriter (new BufferedWriter(new FileWriter(fname, true)));
        System.out.println("\u000C Enter Candidate name::");
        Scanner sc=new Scanner(System.in);
        String name=sc.nextLine();
        System.out.println("Enter Candidate post::");
        String post=sc.nextLine();
        int votes=0;
        name=name.trim(); post=post.trim();
        fw.print("\n"+name+"|"+post+"|"+votes);
        fw.close();
        readfile(fname);
        
      }
      catch (Exception e){
        System.out.println(e);
        }
        finally{
        return result;
    }
    }
    
    public static String[][] poll(String result[][], int i, String fname){
        System.out.println("\u000C !POLL!");
        System.out.println("Index Number\tCandidate");
        for(int i1=1; i1<i; i1++){
                for(int j=0; j<1; j++){
                    System.out.print(i1+"                   \t"+result[i1][j]);
                }
                System.out.println();
            } 
        System.out.println("!Enter Candidate Number YOU ARE VOTING FOR!");
        Scanner sc=new Scanner(System.in);
        int ch=sc.nextInt();
        if(ch<=i){
            int aaa=Integer.parseInt((result[ch][2]));
            aaa=aaa+1;
            result[ch][2]=Integer.toString(aaa);
        }
        
        try {
         PrintWriter fw = new PrintWriter (new BufferedWriter(new FileWriter(fname)));
         for(int i1=0;i1<i ; i1++)
             fw.print(result[i1][0]+"|"+result[i1][1]+"|"+result[i1][2]+"\n");
          fw.close();
          readfile(fname);        
          i = 0; int j=0;
          BufferedReader reader = new BufferedReader(new FileReader(fname));
          String line = "";
          String  lin1;
           while((line=reader.readLine())!=null){
                for (j = 0; j <3; j++) {
                    if(j<2){
                        lin1=line.substring(0,line.indexOf("|"));
                        result[i][j]=lin1;
                        line=line.substring((line.indexOf("|"))+1);
                    }
                    else{
                        result[i][j]=line;
                    }
                }
                i++;
             }
         }
        catch (Exception e){
          System.out.println(e);
        }
        finally{
            return result;
            
        }
            
    }
    
    public static void resultt1(String fname)throws IOException{        
       System.out.println("\u000C ");
       int i = 0, j=0;
       String[][] result = new String[999][3];       
       BufferedReader reader = new BufferedReader(new FileReader(fname));
       String line = "";
       String  lin1;            
       while((line=reader.readLine())!=null){
                for (j = 0; j <3; j++) {                    
                    if(line==""){break;}
                    if(j<2){
                        lin1=line.substring(0,line.indexOf("|"));
                        result[i][j]=lin1;
                        line=line.substring((line.indexOf("|"))+1);
                    }
                    else{
                        result[i][j]=line;
                    }
                 }
                 i++;
             }
             
       for(int i1=0; i1<=i; i1++){
                for(j=0; j<3; j++){
                    System.out.print("\t"+result[i1][j]);
                }
                System.out.println();
            } 
            System.out.println("\n\n");
            resultt(result,i,fname);
    }
     public static void resultt(String result[][], int i, String fname)throws IOException{
         System.out.println("\u000C !RESULTTTT!");
         i=i;
         int max=0 , index=0;
         int rr=0;
         max=0;
         for(int i1=1; i1<i; i1++){
                rr=Integer.parseInt(result[i1][2]);
                if(rr>max){
                    max=rr;
                    index=i1;
                }
            }
         System.out.println("Winner for the post of "+result[index][1]+" is:::");
         System.out.println(result[index][0]+" with a total of "+result[index][2]+" votes.");
         System.out.println(" M: Main()");
         System.out.println(" V: Vote");
         Scanner sc=new Scanner(System.in);
         String ch=sc.nextLine();
         switch (ch){
           case "M" :
           {
              main(args);   
              break;   
           }
                       
           case "V" :
           {
             readfile(fname);   
           }
           
           default : {System.out.println("Wrong Choice.."); main(args);}
        }
     }
     
     public static void efile()throws IOException{
         
       BufferedReader fr=new BufferedReader(new InputStreamReader(System.in));
       System.out.println("\u000C Enter filename:");
       String fname=fr.readLine();
       System.out.println("Entered filename is :: "+fname);
       ecc.main(args,fname); 
        }
        public static void exit()throws IOException{
            System.out.println("\u000C Enter filename:");
            Scanner sc = new Scanner(System.in);
            String fname =sc.nextLine();
            try{
            BufferedReader fi=new BufferedReader(new FileReader(fname+ ".decrypted"));
            
            File ff = new File(fname);
            if(ff.canWrite()==true){
            ff.deleteOnExit();
          }
          else
		  
		{
              System.out.println("File "+fname+" is not writable. PLEASE DELETE THE FILE.");
            }
            
        }
        catch(Exception e){
            System.out.println(e);
        }
    }
        
}
    
    
    
    
